# BandPro æ¨‚åº«èˆ‡å”ä½œç•Œé¢è¨­è¨ˆ

æ¨‚è­œç®¡ç†èˆ‡å¤šäººå”ä½œçš„å®Œæ•´ç•Œé¢è¨­è¨ˆè¦ç¯„

## ğŸ“š æ¨‚åº«ç³»çµ±æ¶æ§‹

### æ¨‚åº«ç•Œé¢å±¤æ¬¡
```mermaid
flowchart TD
    subgraph LibraryInterface[æ¨‚åº«ç•Œé¢å±¤æ¬¡]
        subgraph BrowsingLayer[ç€è¦½å±¤]
            CategoryFilter[åˆ†é¡ç¯©é¸<br/>é¢¨æ ¼/æ¨‚å™¨/é›£åº¦]
            SearchSystem[æœå°‹ç³»çµ±<br/>æ™ºèƒ½æª¢ç´¢]
            SortingOptions[æ’åºé¸é …<br/>æ™‚é–“/è©•åˆ†/ç†±åº¦]
        end
        
        subgraph DisplayLayer[é¡¯ç¤ºå±¤]
            GridView[ç¶²æ ¼æª¢è¦–<br/>ç¸®åœ–å±•ç¤º]
            ListView[åˆ—è¡¨æª¢è¦–<br/>è©³ç´°è³‡è¨Š]
            CardView[å¡ç‰‡æª¢è¦–<br/>é è¦½æ¨¡å¼]
        end
        
        subgraph PreviewLayer[é è¦½å±¤]
            QuickPreview[å¿«é€Ÿé è¦½<br/>å½ˆçª—é¡¯ç¤º]
            AudioPreview[éŸ³é »é è¦½<br/>MIDIæ’­æ”¾]
            ScorePreview[æ¨‚è­œé è¦½<br/>SVGæ¸²æŸ“]
        end
        
        subgraph ActionLayer[æ“ä½œå±¤]
            DownloadActions[ä¸‹è¼‰æ“ä½œ<br/>å¤šæ ¼å¼æ”¯æ´]
            ShareActions[åˆ†äº«æ“ä½œ<br/>é€£çµ/åµŒå…¥]
            CollectionActions[æ”¶è—æ“ä½œ<br/>å€‹äººæ›¸ç±¤]
        end
    end
    
    CategoryFilter --> GridView
    SearchSystem --> ListView
    SortingOptions --> CardView
    
    GridView --> QuickPreview
    ListView --> AudioPreview
    CardView --> ScorePreview
    
    QuickPreview --> DownloadActions
    AudioPreview --> ShareActions
    ScorePreview --> CollectionActions
```

### å”ä½œç³»çµ±æ¶æ§‹
```mermaid
mindmap
  root((å”ä½œç³»çµ±))
    å³æ™‚å”ä½œ
      åŒæ­¥ç·¨è¼¯
        æ“ä½œå»£æ’­
        è¡çªè§£æ±º
        ç‹€æ…‹åŒæ­¥
      å”ä½œæ„ŸçŸ¥
        ç”¨æˆ¶æ¸¸æ¨™
        é¸å–ç‹€æ…‹
        ç·¨è¼¯æŒ‡ç¤º
    æ¬Šé™ç®¡ç†
      å°ˆæ¡ˆæ¬Šé™
        æ“æœ‰è€…
        ç·¨è¼¯è€…
        æª¢è¦–è€…
      åŠŸèƒ½æ¬Šé™
        ç·¨è¼¯æ¬Šé™
        è©•è«–æ¬Šé™
        åˆ†äº«æ¬Šé™
    æºé€šå·¥å…·
      å³æ™‚è©•è«–
        æ¨‚è­œæ¨™è¨»
        è¨è«–ä¸²
        æåŠåŠŸèƒ½
      ç‰ˆæœ¬æ§åˆ¶
        è®Šæ›´æ­·å²
        ç‰ˆæœ¬æ¯”è¼ƒ
        å›å¾©æ©Ÿåˆ¶
```

---

## ğŸ“– æ¨‚åº«ç€è¦½ç•Œé¢

### æ¨‚åº«ä¸»é ä½ˆå±€
```vue
<!-- views/LibraryPage.vue -->
<template>
  <div class="library-page">
    <!-- æ¨‚åº«æ¨™é¡Œèˆ‡å·¥å…·æ¬„ -->
    <header class="library-header">
      <div class="container">
        <div class="header-content">
          <div class="header-title">
            <h1 class="page-title">æ¨‚è­œåº«</h1>
            <p class="page-subtitle">æ¢ç´¢å’Œåˆ†äº«å„ªè³ªæ¨‚è­œ</p>
          </div>
          
          <div class="header-actions">
            <button @click="uploadScore" class="btn btn-primary">
              <CloudArrowUpIcon class="w-4 h-4" />
              ä¸Šå‚³æ¨‚è­œ
            </button>
            
            <div class="view-toggle">
              <button
                v-for="view in viewModes"
                :key="view.id"
                @click="currentView = view.id"
                class="view-btn"
                :class="{ 'view-active': currentView === view.id }"
                :title="view.label"
              >
                <component :is="view.icon" class="w-4 h-4" />
              </button>
            </div>
          </div>
        </div>
        
        <!-- æœå°‹èˆ‡ç¯©é¸å€ -->
        <div class="search-filter-bar">
          <div class="search-section">
            <div class="search-input-wrapper">
              <MagnifyingGlassIcon class="search-icon" />
              <input
                v-model="searchQuery"
                @input="performSearch"
                class="search-input"
                type="text"
                placeholder="æœå°‹æ¨‚è­œã€ä½œæ›²å®¶ã€æ¨™ç±¤..."
              />
              <button v-if="searchQuery" @click="clearSearch" class="clear-search">
                <XMarkIcon class="w-4 h-4" />
              </button>
            </div>
            
            <button @click="toggleAdvancedSearch" class="advanced-search-btn">
              <AdjustmentsHorizontalIcon class="w-4 h-4" />
              é€²éšæœå°‹
            </button>
          </div>
          
          <div class="filter-section">
            <!-- å¿«é€Ÿç¯©é¸ -->
            <div class="quick-filters">
              <select v-model="selectedCategory" class="filter-select">
                <option value="">æ‰€æœ‰åˆ†é¡</option>
                <option v-for="category in categories" :key="category.id" :value="category.id">
                  {{ category.name }}
                </option>
              </select>
              
              <select v-model="selectedDifficulty" class="filter-select">
                <option value="">æ‰€æœ‰é›£åº¦</option>
                <option v-for="level in difficultyLevels" :key="level.id" :value="level.id">
                  {{ level.name }}
                </option>
              </select>
              
              <select v-model="sortBy" class="filter-select">
                <option value="latest">æœ€æ–°ä¸Šå‚³</option>
                <option value="popular">æœ€å—æ­¡è¿</option>
                <option value="rating">è©•åˆ†æœ€é«˜</option>
                <option value="downloads">ä¸‹è¼‰æœ€å¤š</option>
              </select>
            </div>
            
            <!-- æ¨™ç±¤ç¯©é¸ -->
            <div v-if="popularTags.length > 0" class="tag-filters">
              <button
                v-for="tag in popularTags"
                :key="tag.id"
                @click="toggleTag(tag.id)"
                class="tag-filter"
                :class="{ 'tag-active': selectedTags.includes(tag.id) }"
              >
                {{ tag.name }}
              </button>
            </div>
          </div>
        </div>
        
        <!-- é€²éšæœå°‹é¢æ¿ -->
        <Transition name="advanced-search">
          <AdvancedSearchPanel
            v-if="showAdvancedSearch"
            v-model="advancedFilters"
            @search="handleAdvancedSearch"
            @close="showAdvancedSearch = false"
          />
        </Transition>
      </div>
    </header>
    
    <!-- æ¨‚è­œå…§å®¹å€åŸŸ -->
    <main class="library-content">
      <div class="container">
        <!-- æœå°‹çµæœçµ±è¨ˆ -->
        <div v-if="searchQuery || hasActiveFilters" class="search-results-info">
          <p class="results-count">
            æ‰¾åˆ° <strong>{{ totalResults }}</strong> ä»½æ¨‚è­œ
          </p>
          <button v-if="hasActiveFilters" @click="clearAllFilters" class="clear-filters">
            æ¸…é™¤æ‰€æœ‰ç¯©é¸
          </button>
        </div>
        
        <!-- æ¨‚è­œç¶²æ ¼/åˆ—è¡¨ -->
        <div class="scores-container">
          <!-- ç¶²æ ¼æª¢è¦– -->
          <div v-if="currentView === 'grid'" class="scores-grid">
            <ScoreCard
              v-for="score in scores"
              :key="score.id"
              :score="score"
              @preview="showScorePreview"
              @download="downloadScore"
              @favorite="toggleFavorite"
              class="score-grid-item"
            />
          </div>
          
          <!-- åˆ—è¡¨æª¢è¦– -->
          <div v-else-if="currentView === 'list'" class="scores-list">
            <ScoreListItem
              v-for="score in scores"
              :key="score.id"
              :score="score"
              @preview="showScorePreview"
              @download="downloadScore"
              @favorite="toggleFavorite"
              class="score-list-item"
            />
          </div>
          
          <!-- è¼‰å…¥ä¸­ -->
          <div v-if="loading" class="loading-state">
            <div class="loading-spinner"></div>
            <p>è¼‰å…¥æ¨‚è­œä¸­...</p>
          </div>
          
          <!-- ç©ºç‹€æ…‹ -->
          <div v-else-if="scores.length === 0" class="empty-state">
            <MusicalNoteIcon class="empty-icon" />
            <h3 class="empty-title">æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„æ¨‚è­œ</h3>
            <p class="empty-description">è©¦è©¦èª¿æ•´æœå°‹é—œéµå­—æˆ–ç¯©é¸æ¢ä»¶</p>
            <button @click="clearSearch" class="btn btn-primary">æ¸…é™¤æœå°‹</button>
          </div>
        </div>
        
        <!-- åˆ†é æ§åˆ¶ -->
        <div v-if="totalPages > 1" class="pagination">
          <Pagination
            :current-page="currentPage"
            :total-pages="totalPages"
            @page-change="handlePageChange"
          />
        </div>
      </div>
    </main>
    
    <!-- æ¨‚è­œé è¦½æ¨¡æ…‹ -->
    <ScorePreviewModal
      v-if="previewScore"
      :score="previewScore"
      @close="closePreview"
      @download="downloadScore"
      @edit="editScore"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'
import {
  MagnifyingGlassIcon,
  XMarkIcon,
  AdjustmentsHorizontalIcon,
  CloudArrowUpIcon,
  Squares2X2Icon,
  ListBulletIcon,
  MusicalNoteIcon
} from '@heroicons/vue/24/outline'

// æª¢è¦–æ¨¡å¼
const viewModes = [
  { id: 'grid', label: 'ç¶²æ ¼æª¢è¦–', icon: Squares2X2Icon },
  { id: 'list', label: 'åˆ—è¡¨æª¢è¦–', icon: ListBulletIcon }
]

// éŸ¿æ‡‰å¼ç‹€æ…‹
const currentView = ref('grid')
const searchQuery = ref('')
const showAdvancedSearch = ref(false)
const selectedCategory = ref('')
const selectedDifficulty = ref('')
const selectedTags = ref<string[]>([])
const sortBy = ref('latest')
const currentPage = ref(1)
const totalPages = ref(1)
const totalResults = ref(0)
const loading = ref(false)
const previewScore = ref(null)

const advancedFilters = ref({
  composer: '',
  yearRange: [1800, 2024],
  keySignature: '',
  timeSignature: '',
  minDuration: '',
  maxDuration: ''
})

// æ¨¡æ“¬è³‡æ–™
const categories = ref([
  { id: 'classical', name: 'å¤å…¸éŸ³æ¨‚' },
  { id: 'pop', name: 'æµè¡ŒéŸ³æ¨‚' },
  { id: 'jazz', name: 'çˆµå£«æ¨‚' },
  { id: 'folk', name: 'æ°‘è¬ ' }
])

const difficultyLevels = ref([
  { id: 'beginner', name: 'åˆç´š' },
  { id: 'intermediate', name: 'ä¸­ç´š' },
  { id: 'advanced', name: 'é«˜ç´š' },
  { id: 'expert', name: 'å°ˆå®¶ç´š' }
])

const popularTags = ref([
  { id: 'piano', name: 'é‹¼ç´' },
  { id: 'violin', name: 'å°æç´' },
  { id: 'guitar', name: 'å‰ä»–' },
  { id: 'vocal', name: 'è²æ¨‚' }
])

const scores = ref([])

// è¨ˆç®—å±¬æ€§
const hasActiveFilters = computed(() => {
  return selectedCategory.value || 
         selectedDifficulty.value || 
         selectedTags.value.length > 0 ||
         Object.values(advancedFilters.value).some(v => 
           Array.isArray(v) ? v[0] !== 1800 || v[1] !== 2024 : v !== ''
         )
})

// æ–¹æ³•
const performSearch = () => {
  loading.value = true
  // æ¨¡æ“¬ API å‘¼å«
  setTimeout(() => {
    loading.value = false
    // æ›´æ–°æœå°‹çµæœ
  }, 500)
}

const clearSearch = () => {
  searchQuery.value = ''
  performSearch()
}

const toggleAdvancedSearch = () => {
  showAdvancedSearch.value = !showAdvancedSearch.value
}

const handleAdvancedSearch = (filters: any) => {
  advancedFilters.value = filters
  performSearch()
}

const toggleTag = (tagId: string) => {
  const index = selectedTags.value.indexOf(tagId)
  if (index > -1) {
    selectedTags.value.splice(index, 1)
  } else {
    selectedTags.value.push(tagId)
  }
  performSearch()
}

const clearAllFilters = () => {
  selectedCategory.value = ''
  selectedDifficulty.value = ''
  selectedTags.value = []
  advancedFilters.value = {
    composer: '',
    yearRange: [1800, 2024],
    keySignature: '',
    timeSignature: '',
    minDuration: '',
    maxDuration: ''
  }
  performSearch()
}

const showScorePreview = (score: any) => {
  previewScore.value = score
}

const closePreview = () => {
  previewScore.value = null
}

const downloadScore = (score: any) => {
  console.log('Download score:', score.id)
}

const editScore = (score: any) => {
  console.log('Edit score:', score.id)
}

const toggleFavorite = (score: any) => {
  console.log('Toggle favorite:', score.id)
}

const uploadScore = () => {
  console.log('Upload score')
}

const handlePageChange = (page: number) => {
  currentPage.value = page
  performSearch()
}

onMounted(() => {
  performSearch()
})
</script>

<style scoped>
.library-page {
  @apply min-h-screen bg-gray-50 dark:bg-gray-900;
}

/* æ¨‚åº«æ¨™é¡Œ */
.library-header {
  @apply bg-white dark:bg-gray-800;
  @apply border-b border-gray-200 dark:border-gray-700;
  @apply py-6;
}

.header-content {
  @apply flex items-center justify-between mb-6;
}

.header-title {
  @apply space-y-1;
}

.page-title {
  @apply text-3xl font-bold;
  @apply text-gray-900 dark:text-white;
}

.page-subtitle {
  @apply text-gray-600 dark:text-gray-400;
}

.header-actions {
  @apply flex items-center space-x-4;
}

.view-toggle {
  @apply flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1;
}

.view-btn {
  @apply px-3 py-2 rounded-md;
  @apply text-gray-600 dark:text-gray-300;
  @apply hover:text-gray-900 dark:hover:text-white;
  @apply transition-colors duration-200;
  
  &.view-active {
    @apply bg-white dark:bg-gray-600;
    @apply text-gray-900 dark:text-white;
    @apply shadow-sm;
  }
}

/* æœå°‹èˆ‡ç¯©é¸ */
.search-filter-bar {
  @apply space-y-4;
}

.search-section {
  @apply flex items-center space-x-4;
}

.search-input-wrapper {
  @apply relative flex-1 max-w-md;
}

.search-icon {
  @apply absolute left-3 top-1/2 transform -translate-y-1/2;
  @apply w-4 h-4 text-gray-400;
}

.search-input {
  @apply w-full pl-10 pr-10 py-2.5;
  @apply bg-gray-100 dark:bg-gray-700;
  @apply border border-transparent;
  @apply rounded-lg;
  @apply text-gray-900 dark:text-white;
  @apply placeholder-gray-500;
  @apply focus:bg-white dark:focus:bg-gray-600;
  @apply focus:border-blue-500;
  @apply focus:outline-none focus:ring-1 focus:ring-blue-500;
}

.clear-search {
  @apply absolute right-3 top-1/2 transform -translate-y-1/2;
  @apply text-gray-400 hover:text-gray-600;
}

.advanced-search-btn {
  @apply flex items-center space-x-2;
  @apply px-4 py-2.5;
  @apply text-gray-600 dark:text-gray-300;
  @apply hover:text-gray-900 dark:hover:text-white;
  @apply hover:bg-gray-100 dark:hover:bg-gray-700;
  @apply rounded-lg;
  @apply transition-colors duration-200;
}

.filter-section {
  @apply space-y-3;
}

.quick-filters {
  @apply flex flex-wrap gap-3;
}

.filter-select {
  @apply px-3 py-2;
  @apply bg-white dark:bg-gray-700;
  @apply border border-gray-300 dark:border-gray-600;
  @apply rounded-md;
  @apply text-sm;
  @apply focus:border-blue-500 focus:ring-1 focus:ring-blue-500;
}

.tag-filters {
  @apply flex flex-wrap gap-2;
}

.tag-filter {
  @apply px-3 py-1;
  @apply bg-gray-200 dark:bg-gray-700;
  @apply text-gray-700 dark:text-gray-300;
  @apply text-sm rounded-full;
  @apply hover:bg-gray-300 dark:hover:bg-gray-600;
  @apply transition-colors duration-200;
  
  &.tag-active {
    @apply bg-blue-100 dark:bg-blue-900;
    @apply text-blue-700 dark:text-blue-300;
  }
}

/* å…§å®¹å€åŸŸ */
.library-content {
  @apply py-8;
}

.search-results-info {
  @apply flex items-center justify-between mb-6;
  @apply pb-4 border-b border-gray-200 dark:border-gray-700;
}

.results-count {
  @apply text-gray-600 dark:text-gray-400;
}

.clear-filters {
  @apply text-blue-600 dark:text-blue-400;
  @apply hover:text-blue-800 dark:hover:text-blue-300;
  @apply text-sm font-medium;
}

/* æ¨‚è­œé¡¯ç¤º */
.scores-grid {
  @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6;
}

.scores-list {
  @apply space-y-4;
}

/* ç‹€æ…‹é¡¯ç¤º */
.loading-state {
  @apply text-center py-12;
}

.loading-spinner {
  @apply w-8 h-8 border-4 border-blue-500 border-t-transparent;
  @apply rounded-full animate-spin mx-auto mb-4;
}

.empty-state {
  @apply text-center py-12;
}

.empty-icon {
  @apply w-16 h-16 mx-auto mb-4;
  @apply text-gray-300 dark:text-gray-600;
}

.empty-title {
  @apply text-xl font-semibold mb-2;
  @apply text-gray-900 dark:text-white;
}

.empty-description {
  @apply text-gray-600 dark:text-gray-400 mb-6;
}

/* åˆ†é  */
.pagination {
  @apply mt-8 flex justify-center;
}

/* å‹•ç•« */
.advanced-search-enter-active,
.advanced-search-leave-active {
  @apply transition-all duration-300;
}

.advanced-search-enter-from,
.advanced-search-leave-to {
  @apply opacity-0 transform -translate-y-4;
}

/* é€šç”¨æ¨£å¼ */
.container {
  @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8;
}

.btn {
  @apply inline-flex items-center space-x-2;
  @apply px-4 py-2 rounded-lg;
  @apply font-medium;
  @apply transition-colors duration-200;
  @apply focus:outline-none focus:ring-2 focus:ring-offset-2;
  
  &.btn-primary {
    @apply bg-blue-600 hover:bg-blue-700;
    @apply text-white;
    @apply focus:ring-blue-500;
  }
}
</style>
```

---

## ğŸ¼ æ¨‚è­œå¡ç‰‡çµ„ä»¶

### æ¨‚è­œå±•ç¤ºå¡ç‰‡
```vue
<!-- components/library/ScoreCard.vue -->
<template>
  <div class="score-card">
    <!-- æ¨‚è­œç¸®åœ– -->
    <div class="score-thumbnail" @click="$emit('preview', score)">
      <div v-if="score.thumbnail" class="thumbnail-image">
        <img 
          :src="score.thumbnail" 
          :alt="score.title"
          class="thumbnail-img"
        />
      </div>
      <div v-else class="thumbnail-placeholder">
        <MusicalNoteIcon class="placeholder-icon" />
      </div>
      
      <!-- æ’­æ”¾æŒ‰éˆ•è¦†è“‹å±¤ -->
      <div class="play-overlay">
        <button @click.stop="playPreview" class="play-button">
          <PlayIcon v-if="!isPlaying" class="w-6 h-6" />
          <PauseIcon v-else class="w-6 h-6" />
        </button>
      </div>
      
      <!-- é›£åº¦æ¨™ç±¤ -->
      <div class="difficulty-badge" :class="`difficulty-${score.difficulty}`">
        {{ getDifficultyLabel(score.difficulty) }}
      </div>
    </div>
    
    <!-- æ¨‚è­œè³‡è¨Š -->
    <div class="score-info">
      <div class="score-header">
        <h3 class="score-title" @click="$emit('preview', score)">
          {{ score.title }}
        </h3>
        <button 
          @click="$emit('favorite', score)"
          class="favorite-button"
          :class="{ 'is-favorite': score.isFavorite }"
        >
          <HeartIcon class="w-5 h-5" :class="{ 'fill-current': score.isFavorite }" />
        </button>
      </div>
      
      <div class="score-meta">
        <div class="composer">{{ score.composer }}</div>
        <div class="category">{{ score.category }}</div>
      </div>
      
      <!-- æ¨™ç±¤ -->
      <div v-if="score.tags && score.tags.length > 0" class="score-tags">
        <span
          v-for="tag in score.tags.slice(0, 3)"
          :key="tag"
          class="tag"
        >
          {{ tag }}
        </span>
        <span v-if="score.tags.length > 3" class="tag-more">
          +{{ score.tags.length - 3 }}
        </span>
      </div>
      
      <!-- çµ±è¨ˆè³‡è¨Š -->
      <div class="score-stats">
        <div class="stat-item">
          <StarIcon class="stat-icon" />
          <span>{{ score.rating || '-' }}</span>
        </div>
        <div class="stat-item">
          <ArrowDownTrayIcon class="stat-icon" />
          <span>{{ formatNumber(score.downloads) }}</span>
        </div>
        <div class="stat-item">
          <EyeIcon class="stat-icon" />
          <span>{{ formatNumber(score.views) }}</span>
        </div>
      </div>
      
      <!-- æ“ä½œæŒ‰éˆ• -->
      <div class="score-actions">
        <button @click="$emit('preview', score)" class="action-button action-preview">
          <EyeIcon class="w-4 h-4" />
          é è¦½
        </button>
        <button @click="$emit('download', score)" class="action-button action-download">
          <ArrowDownTrayIcon class="w-4 h-4" />
          ä¸‹è¼‰
        </button>
        <div class="dropdown-container">
          <button @click="toggleDropdown" class="action-button action-more">
            <EllipsisHorizontalIcon class="w-4 h-4" />
          </button>
          
          <!-- æ›´å¤šæ“ä½œä¸‹æ‹‰é¸å–® -->
          <Transition name="dropdown">
            <div v-if="showDropdown" class="action-dropdown">
              <button @click="shareScore" class="dropdown-item">
                <ShareIcon class="w-4 h-4" />
                åˆ†äº«
              </button>
              <button @click="reportScore" class="dropdown-item">
                <FlagIcon class="w-4 h-4" />
                æª¢èˆ‰
              </button>
              <button v-if="canEdit" @click="editScore" class="dropdown-item">
                <PencilIcon class="w-4 h-4" />
                ç·¨è¼¯
              </button>
            </div>
          </Transition>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import {
  MusicalNoteIcon,
  PlayIcon,
  PauseIcon,
  HeartIcon,
  StarIcon,
  ArrowDownTrayIcon,
  EyeIcon,
  EllipsisHorizontalIcon,
  ShareIcon,
  FlagIcon,
  PencilIcon
} from '@heroicons/vue/24/outline'

interface Score {
  id: string
  title: string
  composer: string
  category: string
  difficulty: 'beginner' | 'intermediate' | 'advanced' | 'expert'
  thumbnail?: string
  tags?: string[]
  rating?: number
  downloads: number
  views: number
  isFavorite: boolean
  isOwner?: boolean
}

interface Props {
  score: Score
}

const props = defineProps<Props>()

const emit = defineEmits<{
  preview: [score: Score]
  download: [score: Score]
  favorite: [score: Score]
}>()

const isPlaying = ref(false)
const showDropdown = ref(false)

const canEdit = computed(() => props.score.isOwner)

const getDifficultyLabel = (difficulty: string) => {
  const labels = {
    beginner: 'åˆç´š',
    intermediate: 'ä¸­ç´š', 
    advanced: 'é«˜ç´š',
    expert: 'å°ˆå®¶'
  }
  return labels[difficulty] || difficulty
}

const formatNumber = (num: number) => {
  if (num >= 1000000) {
    return Math.floor(num / 100000) / 10 + 'M'
  } else if (num >= 1000) {
    return Math.floor(num / 100) / 10 + 'K'
  }
  return num.toString()
}

const playPreview = () => {
  isPlaying.value = !isPlaying.value
  // æ’­æ”¾éŸ³é »é è¦½é‚è¼¯
}

const toggleDropdown = () => {
  showDropdown.value = !showDropdown.value
}

const shareScore = () => {
  console.log('Share score:', props.score.id)
  showDropdown.value = false
}

const reportScore = () => {
  console.log('Report score:', props.score.id)
  showDropdown.value = false
}

const editScore = () => {
  console.log('Edit score:', props.score.id)
  showDropdown.value = false
}
</script>

<style scoped>
.score-card {
  @apply bg-white dark:bg-gray-800;
  @apply border border-gray-200 dark:border-gray-700;
  @apply rounded-xl overflow-hidden;
  @apply shadow-sm hover:shadow-md;
  @apply transition-all duration-300;
  @apply group;
}

/* ç¸®åœ–å€åŸŸ */
.score-thumbnail {
  @apply relative aspect-[3/2] cursor-pointer;
  @apply bg-gray-100 dark:bg-gray-700;
  @apply overflow-hidden;
}

.thumbnail-image,
.thumbnail-placeholder {
  @apply w-full h-full;
}

.thumbnail-img {
  @apply w-full h-full object-cover;
  @apply group-hover:scale-105 transition-transform duration-300;
}

.thumbnail-placeholder {
  @apply flex items-center justify-center;
}

.placeholder-icon {
  @apply w-12 h-12 text-gray-300 dark:text-gray-600;
}

/* æ’­æ”¾è¦†è“‹å±¤ */
.play-overlay {
  @apply absolute inset-0;
  @apply bg-black bg-opacity-0 group-hover:bg-opacity-30;
  @apply flex items-center justify-center;
  @apply transition-all duration-300;
  @apply opacity-0 group-hover:opacity-100;
}

.play-button {
  @apply w-14 h-14;
  @apply bg-white bg-opacity-90;
  @apply rounded-full;
  @apply flex items-center justify-center;
  @apply text-gray-800;
  @apply transform scale-90 group-hover:scale-100;
  @apply transition-transform duration-300;
  @apply hover:bg-opacity-100;
}

/* é›£åº¦æ¨™ç±¤ */
.difficulty-badge {
  @apply absolute top-2 right-2;
  @apply px-2 py-1;
  @apply text-xs font-medium;
  @apply rounded-full;
  
  &.difficulty-beginner {
    @apply bg-green-100 text-green-800;
    @apply dark:bg-green-900 dark:text-green-200;
  }
  
  &.difficulty-intermediate {
    @apply bg-yellow-100 text-yellow-800;
    @apply dark:bg-yellow-900 dark:text-yellow-200;
  }
  
  &.difficulty-advanced {
    @apply bg-orange-100 text-orange-800;
    @apply dark:bg-orange-900 dark:text-orange-200;
  }
  
  &.difficulty-expert {
    @apply bg-red-100 text-red-800;
    @apply dark:bg-red-900 dark:text-red-200;
  }
}

/* æ¨‚è­œè³‡è¨Š */
.score-info {
  @apply p-4 space-y-3;
}

.score-header {
  @apply flex items-start justify-between;
}

.score-title {
  @apply flex-1 text-lg font-semibold;
  @apply text-gray-900 dark:text-white;
  @apply cursor-pointer;
  @apply hover:text-blue-600 dark:hover:text-blue-400;
  @apply transition-colors duration-200;
  @apply line-clamp-2;
}

.favorite-button {
  @apply ml-2 p-1;
  @apply text-gray-400 hover:text-red-500;
  @apply transition-colors duration-200;
  
  &.is-favorite {
    @apply text-red-500;
  }
}

.score-meta {
  @apply space-y-1;
}

.composer {
  @apply text-gray-600 dark:text-gray-400;
  @apply font-medium;
}

.category {
  @apply text-sm text-gray-500 dark:text-gray-500;
}

/* æ¨™ç±¤ */
.score-tags {
  @apply flex flex-wrap gap-1;
}

.tag {
  @apply px-2 py-1;
  @apply bg-gray-100 dark:bg-gray-700;
  @apply text-gray-600 dark:text-gray-300;
  @apply text-xs rounded;
}

.tag-more {
  @apply px-2 py-1;
  @apply text-gray-500 dark:text-gray-400;
  @apply text-xs;
}

/* çµ±è¨ˆè³‡è¨Š */
.score-stats {
  @apply flex items-center space-x-4;
}

.stat-item {
  @apply flex items-center space-x-1;
  @apply text-sm text-gray-500 dark:text-gray-400;
}

.stat-icon {
  @apply w-4 h-4;
}

/* æ“ä½œæŒ‰éˆ• */
.score-actions {
  @apply flex items-center space-x-2;
}

.action-button {
  @apply flex items-center space-x-1;
  @apply px-3 py-2;
  @apply text-sm font-medium;
  @apply rounded-md;
  @apply transition-colors duration-200;
  
  &.action-preview {
    @apply text-blue-600 dark:text-blue-400;
    @apply bg-blue-50 dark:bg-blue-900/20;
    @apply hover:bg-blue-100 dark:hover:bg-blue-900/30;
  }
  
  &.action-download {
    @apply text-green-600 dark:text-green-400;
    @apply bg-green-50 dark:bg-green-900/20;
    @apply hover:bg-green-100 dark:hover:bg-green-900/30;
  }
  
  &.action-more {
    @apply text-gray-600 dark:text-gray-400;
    @apply hover:bg-gray-100 dark:hover:bg-gray-700;
  }
}

/* ä¸‹æ‹‰é¸å–® */
.dropdown-container {
  @apply relative;
}

.action-dropdown {
  @apply absolute top-full right-0 mt-1;
  @apply bg-white dark:bg-gray-800;
  @apply border border-gray-200 dark:border-gray-700;
  @apply rounded-lg shadow-lg;
  @apply min-w-32;
  @apply z-10;
}

.dropdown-item {
  @apply w-full flex items-center space-x-2;
  @apply px-3 py-2;
  @apply text-sm text-left;
  @apply text-gray-700 dark:text-gray-300;
  @apply hover:bg-gray-100 dark:hover:bg-gray-700;
  @apply transition-colors duration-200;
  
  &:first-child {
    @apply rounded-t-lg;
  }
  
  &:last-child {
    @apply rounded-b-lg;
  }
}

/* å‹•ç•« */
.dropdown-enter-active,
.dropdown-leave-active {
  @apply transition-all duration-200;
}

.dropdown-enter-from,
.dropdown-leave-to {
  @apply opacity-0 transform scale-95 -translate-y-1;
}
</style>
```

---

## ğŸ¤ å”ä½œç•Œé¢è¨­è¨ˆ

ç”±æ–¼å…§å®¹è¼ƒé•·ï¼Œå°‡å”ä½œç•Œé¢è¨­è¨ˆæ‹†åˆ†åˆ°ä¸‹ä¸€å€‹æ–‡ä»¶ä¸­ã€‚

## âœ… æœ¬æ–‡ä»¶åŒ…å«å…§å®¹

1. **æ¨‚åº«ç³»çµ±æ¶æ§‹** - ç€è¦½ã€é¡¯ç¤ºã€é è¦½ã€æ“ä½œå››å±¤æ¶æ§‹
2. **å”ä½œç³»çµ±æ¶æ§‹** - å³æ™‚å”ä½œã€æ¬Šé™ç®¡ç†ã€æºé€šå·¥å…·
3. **æ¨‚åº«ç€è¦½ç•Œé¢** - å®Œæ•´çš„æ¨‚è­œç€è¦½é é¢ï¼ŒåŒ…å«æœå°‹ã€ç¯©é¸ã€åˆ†é 
4. **æ¨‚è­œå¡ç‰‡çµ„ä»¶** - è©³ç´°çš„æ¨‚è­œå±•ç¤ºå¡ç‰‡ï¼Œæ”¯æ´é è¦½ã€ä¸‹è¼‰ã€æ”¶è—

## ğŸ”— ç›¸é—œæ–‡ä»¶

ğŸ‘‰ **ä¸‹ä¸€æ­¥ï¼šåƒè€ƒ [08_ç”¨æˆ¶ç³»çµ±ç•Œé¢.md](./08_ç”¨æˆ¶ç³»çµ±ç•Œé¢.md) äº†è§£ç”¨æˆ¶ç³»çµ±å’Œè¨­å®šç•Œé¢è¨­è¨ˆ**

ğŸ‘‰ **ä¸¦è¡Œï¼šåƒè€ƒ [09_ç„¡éšœç¤™è¨­è¨ˆè¦ç¯„.md](./09_ç„¡éšœç¤™è¨­è¨ˆè¦ç¯„.md) äº†è§£ç„¡éšœç¤™è¨­è¨ˆè¦æ±‚**
