# BandPro ç„¡éšœç¤™è¨­è¨ˆè¦ç¯„

ç¬¦åˆ WCAG 2.1 AA æ¨™æº–çš„å®Œæ•´ç„¡éšœç¤™è¨­è¨ˆæŒ‡å°åŸå‰‡

## â™¿ ç„¡éšœç¤™è¨­è¨ˆæ¶æ§‹

### ç„¡éšœç¤™å±¤æ¬¡æ¡†æ¶
```mermaid
flowchart TD
    subgraph AccessibilityFramework[ç„¡éšœç¤™è¨­è¨ˆæ¡†æ¶]
        subgraph PerceptionLayer[å¯æ„ŸçŸ¥æ€§]
            TextAlternatives[æ–‡å­—æ›¿ä»£<br/>åœ–åƒ/åª’é«”æè¿°]
            ColorContrast[è‰²å½©å°æ¯”<br/>4.5:1 æ¨™æº–]
            ScalableContent[å¯ç¸®æ”¾å…§å®¹<br/>200% æ”¾å¤§æ”¯æ´]
        end
        
        subgraph OperationLayer[å¯æ“ä½œæ€§]
            KeyboardNavigation[éµç›¤å°èˆª<br/>Tab é †åºç®¡ç†]
            FocusManagement[ç„¦é»ç®¡ç†<br/>è¦–è¦ºæŒ‡ç¤ºå™¨]
            TimingControls[æ™‚é–“æ§åˆ¶<br/>æš«åœ/å»¶é•·é¸é …]
        end
        
        subgraph UnderstandingLayer[å¯ç†è§£æ€§]
            StructuredContent[çµæ§‹åŒ–å…§å®¹<br/>æ¨™é¡Œå±¤æ¬¡]
            ConsistentNavigation[ä¸€è‡´å°èˆª<br/>ä»‹é¢æ¨¡å¼]
            ErrorPrevention[éŒ¯èª¤é é˜²<br/>è¼¸å…¥é©—è­‰]
        end
        
        subgraph RobustnessLayer[å¼·å¥æ€§]
            SemanticMarkup[èªæ„æ¨™è¨˜<br/>ARIA æ¨™ç±¤]
            ScreenReaderSupport[è¢å¹•é–±è®€å™¨<br/>ç›¸å®¹æ€§æ”¯æ´]
            DeviceCompatibility[è£ç½®ç›¸å®¹æ€§<br/>è¼”åŠ©æŠ€è¡“]
        end
    end
    
    TextAlternatives --> KeyboardNavigation
    ColorContrast --> FocusManagement
    ScalableContent --> TimingControls
    
    KeyboardNavigation --> StructuredContent
    FocusManagement --> ConsistentNavigation
    TimingControls --> ErrorPrevention
    
    StructuredContent --> SemanticMarkup
    ConsistentNavigation --> ScreenReaderSupport
    ErrorPrevention --> DeviceCompatibility
```

### éŸ³æ¨‚è»Ÿé«”å°ˆç”¨ç„¡éšœç¤™éœ€æ±‚
```mermaid
mindmap
  root((éŸ³æ¨‚ç„¡éšœç¤™))
    è¦–è¦ºç„¡éšœç¤™
      è‰²å½©è­˜åˆ¥
        éŸ³ç¬¦è‰²ç¢¼æ›¿ä»£
        èª¿è™Ÿè¦–è¦ºæç¤º
        å¼·å¼±è¨˜è™Ÿæ¨™ç¤º
      æ–‡å­—æ”¯æ´
        æ¨‚è­œæè¿°
        å’Œå¼¦æ¨™è¨˜
        æ­Œè©é¡¯ç¤º
    è½è¦ºç„¡éšœç¤™
      è¦–è¦ºåŒ–å›é¥‹
        éŸ³ç¬¦é–ƒçˆ
        ç¯€æ‹æŒ‡ç¤º
        éŸ³é«˜è¦–è¦ºåŒ–
      è§¸è¦ºå›é¥‹
        æŒ¯å‹•æ¨¡å¼
        åŠ›åº¦æ„ŸçŸ¥
        ç¯€å¥è§¸æ„Ÿ
    æ“ä½œç„¡éšœç¤™
      éµç›¤æ“ä½œ
        éŸ³ç¬¦è¼¸å…¥
        å°èˆªå¿«æ·
        ç·¨è¼¯åŠŸèƒ½
      èªéŸ³æ§åˆ¶
        èªéŸ³è¼¸å…¥
        æŒ‡ä»¤è­˜åˆ¥
        éŸ³æ¨‚è¡“èª
    èªçŸ¥ç„¡éšœç¤™
      ç°¡åŒ–ä»‹é¢
        åŸºæœ¬æ¨¡å¼
        é€²éšåˆ‡æ›
        æ•™å­¸å¼•å°
      è¨˜æ†¶è¼”åŠ©
        å¸¸ç”¨æ¨¡ç‰ˆ
        æ­·å²è¨˜éŒ„
        è‡ªå‹•å®Œæˆ
```

---

## ğŸ¨ è‰²å½©èˆ‡å°æ¯”è¨­è¨ˆ

### è‰²å½©ç„¡éšœç¤™è¦ç¯„
```vue
<!-- composables/useAccessibleColors.ts -->
<template>
  <div class="accessible-colors-demo">
    <!-- è‰²å½©å°æ¯”æ¸¬è©¦ -->
    <div class="color-contrast-section">
      <h3 class="section-title">è‰²å½©å°æ¯”æ¸¬è©¦</h3>
      
      <div class="contrast-examples">
        <!-- æ¨™æº–å°æ¯” (4.5:1) -->
        <div class="contrast-example">
          <div class="contrast-sample standard-contrast">
            <span class="contrast-text">æ¨™æº–æ–‡å­— (4.5:1)</span>
          </div>
          <div class="contrast-info">
            <div class="contrast-ratio">4.51:1</div>
            <div class="contrast-status pass">âœ“ AA é€šé</div>
          </div>
        </div>
        
        <!-- å¢å¼·å°æ¯” (7:1) -->
        <div class="contrast-example">
          <div class="contrast-sample enhanced-contrast">
            <span class="contrast-text">å¢å¼·æ–‡å­— (7:1)</span>
          </div>
          <div class="contrast-info">
            <div class="contrast-ratio">7.21:1</div>
            <div class="contrast-status pass">âœ“ AAA é€šé</div>
          </div>
        </div>
        
        <!-- å¤§å­—é«”å°æ¯” (3:1) -->
        <div class="contrast-example">
          <div class="contrast-sample large-text-contrast">
            <span class="contrast-text large-text">å¤§å­—é«” (3:1)</span>
          </div>
          <div class="contrast-info">
            <div class="contrast-ratio">3.12:1</div>
            <div class="contrast-status pass">âœ“ AA å¤§å­—é«”</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- è‰²ç›²å‹å¥½è¨­è¨ˆ -->
    <div class="colorblind-friendly-section">
      <h3 class="section-title">è‰²ç›²å‹å¥½è¨­è¨ˆ</h3>
      
      <div class="colorblind-examples">
        <!-- éŸ³ç¬¦ç‹€æ…‹æŒ‡ç¤º -->
        <div class="note-status-examples">
          <h4 class="subsection-title">éŸ³ç¬¦ç‹€æ…‹æŒ‡ç¤º</h4>
          
          <div class="status-indicators">
            <div class="status-item">
              <div class="note-indicator selected">
                <MusicalNoteIcon class="note-icon" />
                <div class="status-pattern selected-pattern"></div>
              </div>
              <span class="status-label">å·²é¸å–</span>
            </div>
            
            <div class="status-item">
              <div class="note-indicator error">
                <MusicalNoteIcon class="note-icon" />
                <div class="status-pattern error-pattern"></div>
              </div>
              <span class="status-label">éŒ¯èª¤</span>
            </div>
            
            <div class="status-item">
              <div class="note-indicator playing">
                <MusicalNoteIcon class="note-icon" />
                <div class="status-pattern playing-pattern"></div>
              </div>
              <span class="status-label">æ’­æ”¾ä¸­</span>
            </div>
          </div>
        </div>
        
        <!-- èª¿è™Ÿè¦–è¦ºåŒ– -->
        <div class="key-signature-examples">
          <h4 class="subsection-title">èª¿è™Ÿè¦–è¦ºåŒ–</h4>
          
          <div class="key-signatures">
            <div class="key-signature-item">
              <div class="key-indicator sharp">
                <span class="key-symbol">â™¯</span>
                <div class="key-pattern sharp-pattern"></div>
              </div>
              <span class="key-label">å‡è™Ÿ + å‘ä¸Šç®­é ­</span>
            </div>
            
            <div class="key-signature-item">
              <div class="key-indicator flat">
                <span class="key-symbol">â™­</span>
                <div class="key-pattern flat-pattern"></div>
              </div>
              <span class="key-label">é™è™Ÿ + å‘ä¸‹ç®­é ­</span>
            </div>
            
            <div class="key-signature-item">
              <div class="key-indicator natural">
                <span class="key-symbol">â™®</span>
                <div class="key-pattern natural-pattern"></div>
              </div>
              <span class="key-label">é‚„åŸè™Ÿ + åœ“é»</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { MusicalNoteIcon } from '@heroicons/vue/24/outline'

// è‰²å½©å°æ¯”è¨ˆç®—
const calculateContrast = (color1: string, color2: string): number => {
  // å¯¦ç¾è‰²å½©å°æ¯”åº¦è¨ˆç®—
  // è¿”å›å°æ¯”åº¦æ¯”å€¼
  return 4.5
}

// è‰²ç›²å‹å¥½è‰²å½©æ–¹æ¡ˆ
const colorBlindFriendlyPalette = {
  // é©ç”¨æ–¼å¤šç¨®è‰²ç›²çš„å®‰å…¨è‰²å½©
  primary: '#0066CC',      // è—è‰²
  secondary: '#FF6600',    // æ©™è‰²
  success: '#228B22',      // æ£®æ—ç¶ 
  warning: '#FFD700',      // é‡‘è‰²
  error: '#DC143C',        // æ·±ç´…è‰²
  info: '#4682B4',         // é‹¼è—è‰²
  
  // ç°éšè¼”åŠ©
  gray100: '#F7FAFC',
  gray200: '#EDF2F7',
  gray500: '#718096',
  gray800: '#2D3748'
}

// ç„¡éšœç¤™è‰²å½©å·¥å…·
const accessibleColors = {
  // æª¢æŸ¥è‰²å½©å°æ¯”åº¦
  checkContrast: (foreground: string, background: string) => {
    const ratio = calculateContrast(foreground, background)
    return {
      ratio,
      passAA: ratio >= 4.5,
      passAAA: ratio >= 7,
      passAALarge: ratio >= 3
    }
  },
  
  // ç²å–é«˜å°æ¯”åº¦ç‰ˆæœ¬
  getHighContrast: (color: string) => {
    // å¯¦ç¾é«˜å°æ¯”åº¦è‰²å½©ç”Ÿæˆ
    return color
  },
  
  // è‰²ç›²æ¨¡æ“¬
  simulateColorBlindness: (color: string, type: string) => {
    // å¯¦ç¾è‰²ç›²æ¨¡æ“¬
    return color
  }
}
</script>

<style scoped>
/* è‰²å½©å°æ¯”ç¯„ä¾‹ */
.accessible-colors-demo {
  @apply p-6 space-y-8;
}

.section-title {
  @apply text-xl font-semibold mb-4;
  @apply text-gray-900 dark:text-white;
}

.subsection-title {
  @apply text-lg font-medium mb-3;
  @apply text-gray-800 dark:text-gray-200;
}

/* å°æ¯”åº¦æ¸¬è©¦ */
.contrast-examples {
  @apply space-y-4;
}

.contrast-example {
  @apply flex items-center space-x-4;
  @apply p-4 bg-white dark:bg-gray-800;
  @apply rounded-lg border border-gray-200 dark:border-gray-700;
}

.contrast-sample {
  @apply flex-1 p-4 rounded-md;
}

.standard-contrast {
  @apply bg-white text-gray-700;
  /* 4.5:1 å°æ¯”åº¦ */
}

.enhanced-contrast {
  @apply bg-white text-gray-900;
  /* 7:1 å°æ¯”åº¦ */
}

.large-text-contrast {
  @apply bg-white text-gray-600;
  /* 3:1 å°æ¯”åº¦é©ç”¨æ–¼å¤§å­—é«” */
}

.contrast-text {
  @apply font-medium;
}

.large-text {
  @apply text-xl;
}

.contrast-info {
  @apply text-right space-y-1;
}

.contrast-ratio {
  @apply text-lg font-bold;
  @apply text-gray-900 dark:text-white;
}

.contrast-status {
  @apply text-sm font-medium;
  
  &.pass {
    @apply text-green-600 dark:text-green-400;
  }
  
  &.fail {
    @apply text-red-600 dark:text-red-400;
  }
}

/* è‰²ç›²å‹å¥½è¨­è¨ˆ */
.colorblind-examples {
  @apply space-y-6;
}

/* éŸ³ç¬¦ç‹€æ…‹æŒ‡ç¤ºå™¨ */
.status-indicators {
  @apply flex flex-wrap gap-4;
}

.status-item {
  @apply flex flex-col items-center space-y-2;
}

.note-indicator {
  @apply relative w-12 h-12;
  @apply flex items-center justify-center;
  @apply rounded-md;
  
  &.selected {
    @apply bg-blue-100 dark:bg-blue-900;
    @apply border-2 border-blue-500;
  }
  
  &.error {
    @apply bg-red-100 dark:bg-red-900;
    @apply border-2 border-red-500;
  }
  
  &.playing {
    @apply bg-green-100 dark:bg-green-900;
    @apply border-2 border-green-500;
  }
}

.note-icon {
  @apply w-6 h-6;
}

.status-pattern {
  @apply absolute top-1 right-1;
  @apply w-3 h-3;
  
  &.selected-pattern {
    @apply bg-blue-500;
    /* æ–¹å½¢åœ–æ¡ˆè¡¨ç¤ºé¸å– */
  }
  
  &.error-pattern {
    @apply bg-red-500;
    /* X åœ–æ¡ˆè¡¨ç¤ºéŒ¯èª¤ */
    &::before {
      content: 'Ã—';
      @apply text-white text-xs;
      @apply absolute inset-0;
      @apply flex items-center justify-center;
    }
  }
  
  &.playing-pattern {
    @apply bg-green-500 rounded-full;
    /* åœ“å½¢åœ–æ¡ˆè¡¨ç¤ºæ’­æ”¾ */
    animation: pulse 1s infinite;
  }
}

.status-label {
  @apply text-sm text-gray-600 dark:text-gray-400;
}

/* èª¿è™Ÿè¦–è¦ºåŒ– */
.key-signatures {
  @apply flex flex-wrap gap-4;
}

.key-signature-item {
  @apply flex flex-col items-center space-y-2;
}

.key-indicator {
  @apply relative w-16 h-16;
  @apply flex items-center justify-center;
  @apply bg-gray-100 dark:bg-gray-700;
  @apply rounded-lg;
  
  &.sharp {
    @apply border-l-4 border-yellow-500;
  }
  
  &.flat {
    @apply border-b-4 border-blue-500;
  }
  
  &.natural {
    @apply border-2 border-gray-400;
  }
}

.key-symbol {
  @apply text-2xl font-bold;
  @apply text-gray-800 dark:text-gray-200;
}

.key-pattern {
  @apply absolute top-2 right-2;
  @apply w-4 h-4;
  
  &.sharp-pattern {
    /* å‘ä¸Šç®­é ­ */
    &::before {
      content: 'â†‘';
      @apply text-yellow-500 font-bold;
    }
  }
  
  &.flat-pattern {
    /* å‘ä¸‹ç®­é ­ */
    &::before {
      content: 'â†“';
      @apply text-blue-500 font-bold;
    }
  }
  
  &.natural-pattern {
    @apply bg-gray-500 rounded-full;
    /* åœ“é» */
  }
}

.key-label {
  @apply text-sm text-gray-600 dark:text-gray-400;
  @apply text-center;
}

/* å‹•ç•« */
@keyframes pulse {
  0%, 100% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.1);
    opacity: 0.8;
  }
}
</style>
```

---

## âŒ¨ï¸ éµç›¤å°èˆªè¨­è¨ˆ

### éµç›¤å°èˆªç³»çµ±
```typescript
// composables/useKeyboardNavigation.ts
import { ref, onMounted, onUnmounted } from 'vue'

export interface FocusableElement {
  element: HTMLElement
  tabIndex: number
  group?: string
  priority?: number
}

export const useKeyboardNavigation = () => {
  const focusableElements = ref<FocusableElement[]>([])
  const currentFocusIndex = ref(-1)
  const trapFocus = ref(false)
  
  // éµç›¤å¿«æ·éµæ˜ å°„
  const keyboardShortcuts = {
    // å°èˆªå¿«æ·éµ
    navigation: {
      'Tab': 'nextFocus',
      'Shift+Tab': 'previousFocus',
      'Home': 'firstFocus',
      'End': 'lastFocus',
      'ArrowUp': 'upFocus',
      'ArrowDown': 'downFocus',
      'ArrowLeft': 'leftFocus',
      'ArrowRight': 'rightFocus',
      'Escape': 'exitFocus'
    },
    
    // ç·¨è¼¯å¿«æ·éµ
    editing: {
      'Ctrl+Z': 'undo',
      'Ctrl+Y': 'redo',
      'Ctrl+X': 'cut',
      'Ctrl+C': 'copy',
      'Ctrl+V': 'paste',
      'Delete': 'delete',
      'Backspace': 'backspace'
    },
    
    // éŸ³æ¨‚å°ˆç”¨å¿«æ·éµ
    music: {
      'Space': 'togglePlayback',
      'Enter': 'addNote',
      '1': 'wholeNote',
      '2': 'halfNote',
      '4': 'quarterNote',
      '8': 'eighthNote',
      'S': 'sharp',
      'F': 'flat',
      'N': 'natural'
    }
  }
  
  // è¨»å†Šç„¦é»å…ƒç´ 
  const registerFocusable = (element: HTMLElement, options?: {
    tabIndex?: number
    group?: string
    priority?: number
  }) => {
    const focusableElement: FocusableElement = {
      element,
      tabIndex: options?.tabIndex ?? 0,
      group: options?.group,
      priority: options?.priority ?? 0
    }
    
    focusableElements.value.push(focusableElement)
    
    // æŒ‰å„ªå…ˆç´šå’Œ tabIndex æ’åº
    focusableElements.value.sort((a, b) => {
      if (a.priority !== b.priority) {
        return (b.priority || 0) - (a.priority || 0)
      }
      return a.tabIndex - b.tabIndex
    })
  }
  
  // ç§»é™¤ç„¦é»å…ƒç´ 
  const unregisterFocusable = (element: HTMLElement) => {
    const index = focusableElements.value.findIndex(
      item => item.element === element
    )
    if (index > -1) {
      focusableElements.value.splice(index, 1)
    }
  }
  
  // ç„¦é»ç§»å‹•æ–¹æ³•
  const moveFocus = (direction: 'next' | 'previous' | 'first' | 'last') => {
    const elements = focusableElements.value
    if (elements.length === 0) return
    
    let newIndex: number
    
    switch (direction) {
      case 'next':
        newIndex = currentFocusIndex.value < elements.length - 1 
          ? currentFocusIndex.value + 1 
          : trapFocus.value ? 0 : currentFocusIndex.value
        break
      case 'previous':
        newIndex = currentFocusIndex.value > 0 
          ? currentFocusIndex.value - 1 
          : trapFocus.value ? elements.length - 1 : currentFocusIndex.value
        break
      case 'first':
        newIndex = 0
        break
      case 'last':
        newIndex = elements.length - 1
        break
    }
    
    if (newIndex !== currentFocusIndex.value) {
      currentFocusIndex.value = newIndex
      elements[newIndex].element.focus()
    }
  }
  
  // æ–¹å‘æ€§ç„¦é»ç§»å‹•ï¼ˆç”¨æ–¼ç¶²æ ¼ä½ˆå±€ï¼‰
  const moveDirectionalFocus = (direction: 'up' | 'down' | 'left' | 'right') => {
    // å¯¦ç¾åŸºæ–¼ç©ºé–“ä½ç½®çš„ç„¦é»ç§»å‹•
    const currentElement = focusableElements.value[currentFocusIndex.value]?.element
    if (!currentElement) return
    
    const currentRect = currentElement.getBoundingClientRect()
    let bestMatch: { element: HTMLElement; distance: number } | null = null
    
    focusableElements.value.forEach(item => {
      const rect = item.element.getBoundingClientRect()
      let isValidDirection = false
      let distance = 0
      
      switch (direction) {
        case 'up':
          isValidDirection = rect.bottom <= currentRect.top
          distance = currentRect.top - rect.bottom
          break
        case 'down':
          isValidDirection = rect.top >= currentRect.bottom
          distance = rect.top - currentRect.bottom
          break
        case 'left':
          isValidDirection = rect.right <= currentRect.left
          distance = currentRect.left - rect.right
          break
        case 'right':
          isValidDirection = rect.left >= currentRect.right
          distance = rect.left - currentRect.right
          break
      }
      
      if (isValidDirection && (!bestMatch || distance < bestMatch.distance)) {
        bestMatch = { element: item.element, distance }
      }
    })
    
    if (bestMatch) {
      bestMatch.element.focus()
    }
  }
  
  // éµç›¤äº‹ä»¶è™•ç†
  const handleKeydown = (event: KeyboardEvent) => {
    const key = event.key
    const modifiers = []
    
    if (event.ctrlKey) modifiers.push('Ctrl')
    if (event.shiftKey) modifiers.push('Shift')
    if (event.altKey) modifiers.push('Alt')
    if (event.metaKey) modifiers.push('Meta')
    
    const keyCombo = modifiers.length > 0 
      ? `${modifiers.join('+')}+${key}` 
      : key
    
    // æª¢æŸ¥å°èˆªå¿«æ·éµ
    if (keyboardShortcuts.navigation[keyCombo]) {
      event.preventDefault()
      
      switch (keyboardShortcuts.navigation[keyCombo]) {
        case 'nextFocus':
          moveFocus('next')
          break
        case 'previousFocus':
          moveFocus('previous')
          break
        case 'firstFocus':
          moveFocus('first')
          break
        case 'lastFocus':
          moveFocus('last')
          break
        case 'upFocus':
          moveDirectionalFocus('up')
          break
        case 'downFocus':
          moveDirectionalFocus('down')
          break
        case 'leftFocus':
          moveDirectionalFocus('left')
          break
        case 'rightFocus':
          moveDirectionalFocus('right')
          break
        case 'exitFocus':
          if (trapFocus.value) {
            document.body.focus()
          }
          break
      }
    }
  }
  
  // ç„¦é»é™·é˜±
  const setFocusTrap = (enabled: boolean, container?: HTMLElement) => {
    trapFocus.value = enabled
    
    if (enabled && container) {
      // æ‰¾åˆ°å®¹å™¨å…§çš„æ‰€æœ‰å¯ç„¦é»å…ƒç´ 
      const trapElements = focusableElements.value.filter(
        item => container.contains(item.element)
      )
      
      if (trapElements.length > 0) {
        trapElements[0].element.focus()
      }
    }
  }
  
  // è·³éé€£çµåŠŸèƒ½
  const addSkipLink = (target: string, label: string) => {
    const skipLink = document.createElement('a')
    skipLink.href = `#${target}`
    skipLink.textContent = label
    skipLink.className = 'skip-link'
    
    // æ¨£å¼
    skipLink.style.cssText = `
      position: absolute;
      top: -40px;
      left: 6px;
      background: #000;
      color: #fff;
      padding: 8px 16px;
      text-decoration: none;
      border-radius: 4px;
      z-index: 1000;
      transition: top 0.3s;
    `
    
    skipLink.addEventListener('focus', () => {
      skipLink.style.top = '6px'
    })
    
    skipLink.addEventListener('blur', () => {
      skipLink.style.top = '-40px'
    })
    
    document.body.insertBefore(skipLink, document.body.firstChild)
  }
  
  onMounted(() => {
    document.addEventListener('keydown', handleKeydown)
    
    // æ·»åŠ è·³éé€£çµ
    addSkipLink('main-content', 'è·³è‡³ä¸»è¦å…§å®¹')
    addSkipLink('main-navigation', 'è·³è‡³ä¸»è¦å°èˆª')
  })
  
  onUnmounted(() => {
    document.removeEventListener('keydown', handleKeydown)
  })
  
  return {
    focusableElements,
    currentFocusIndex,
    registerFocusable,
    unregisterFocusable,
    moveFocus,
    moveDirectionalFocus,
    setFocusTrap,
    keyboardShortcuts
  }
}
```

---

## ğŸ“± è¢å¹•é–±è®€å™¨æ”¯æ´

### ARIA æ¨™ç±¤èˆ‡èªæ„æ¨™è¨˜
```vue
<!-- components/accessibility/AccessibleEditor.vue -->
<template>
  <div 
    class="accessible-music-editor"
    role="application"
    :aria-label="editorLabel"
    :aria-describedby="editorDescriptionId"
  >
    <!-- ç·¨è¼¯å™¨æè¿° -->
    <div :id="editorDescriptionId" class="sr-only">
      éŸ³æ¨‚ç·¨è¼¯å™¨ï¼Œä½¿ç”¨éµç›¤å¿«æ·éµé€²è¡ŒéŸ³ç¬¦è¼¸å…¥å’Œç·¨è¼¯æ“ä½œ
    </div>
    
    <!-- å·¥å…·æ¬„ -->
    <div 
      class="editor-toolbar"
      role="toolbar"
      aria-label="ç·¨è¼¯å·¥å…·"
      :aria-controls="canvasId"
    >
      <div class="tool-groups">
        <!-- éŸ³ç¬¦å·¥å…·çµ„ -->
        <div 
          class="tool-group"
          role="group"
          aria-labelledby="note-tools-label"
        >
          <div id="note-tools-label" class="tool-group-label">
            éŸ³ç¬¦å·¥å…·
          </div>
          
          <button
            v-for="note in noteTools"
            :key="note.id"
            @click="selectTool(note)"
            class="tool-button"
            role="button"
            :aria-pressed="selectedTool?.id === note.id"
            :aria-label="note.ariaLabel"
            :aria-describedby="`${note.id}-desc`"
            :aria-keyshortcuts="note.shortcut"
          >
            <span class="tool-icon" :aria-hidden="true">{{ note.symbol }}</span>
            <span class="sr-only">{{ note.name }}</span>
            
            <!-- å·¥å…·æè¿° -->
            <div :id="`${note.id}-desc`" class="sr-only">
              {{ note.description }}ã€‚å¿«æ·éµï¼š{{ note.shortcut }}
            </div>
          </button>
        </div>
        
        <!-- æ’­æ”¾æ§åˆ¶çµ„ -->
        <div 
          class="tool-group"
          role="group"
          aria-labelledby="playback-controls-label"
        >
          <div id="playback-controls-label" class="tool-group-label">
            æ’­æ”¾æ§åˆ¶
          </div>
          
          <button
            @click="togglePlayback"
            class="tool-button play-button"
            :aria-label="isPlaying ? 'æš«åœæ’­æ”¾' : 'é–‹å§‹æ’­æ”¾'"
            :aria-keyshortcuts="'Space'"
          >
            <PlayIcon v-if="!isPlaying" class="tool-icon" aria-hidden="true" />
            <PauseIcon v-else class="tool-icon" aria-hidden="true" />
            <span class="sr-only">
              {{ isPlaying ? 'æš«åœ' : 'æ’­æ”¾' }}
            </span>
          </button>
          
          <button
            @click="stopPlayback"
            class="tool-button"
            aria-label="åœæ­¢æ’­æ”¾"
          >
            <StopIcon class="tool-icon" aria-hidden="true" />
            <span class="sr-only">åœæ­¢</span>
          </button>
        </div>
      </div>
    </div>
    
    <!-- æ¨‚è­œç•«å¸ƒå€åŸŸ -->
    <main 
      :id="canvasId"
      class="score-canvas-container"
      role="img"
      :aria-label="scoreDescription"
      :aria-describedby="scoreDetailsId"
      tabindex="0"
      @keydown="handleCanvasKeydown"
      @focus="announceCanvasFocus"
    >
      <!-- æ¨‚è­œæè¿° -->
      <div :id="scoreDetailsId" class="sr-only">
        {{ scoreStructureDescription }}
      </div>
      
      <!-- äº”ç·šè­œç³»çµ± -->
      <div 
        v-for="(system, systemIndex) in staffSystems"
        :key="systemIndex"
        class="staff-system"
        :aria-label="`äº”ç·šè­œç³»çµ± ${systemIndex + 1}`"
        role="group"
      >
        <!-- å°ç¯€ -->
        <div
          v-for="(measure, measureIndex) in system.measures"
          :key="measureIndex"
          class="measure"
          :aria-label="`ç¬¬ ${measureIndex + 1} å°ç¯€`"
          role="group"
          :tabindex="0"
          @focus="announceMeasure(systemIndex, measureIndex)"
        >
          <!-- éŸ³ç¬¦ -->
          <div
            v-for="(note, noteIndex) in measure.notes"
            :key="noteIndex"
            class="note"
            role="button"
            :tabindex="0"
            :aria-label="getNoteAriaLabel(note)"
            :aria-describedby="`note-${systemIndex}-${measureIndex}-${noteIndex}-desc`"
            :aria-selected="isNoteSelected(note)"
            @click="selectNote(note)"
            @keydown="handleNoteKeydown($event, note)"
            @focus="announceNote(note)"
          >
            <!-- éŸ³ç¬¦è¦–è¦ºè¡¨ç¤º -->
            <span class="note-symbol" aria-hidden="true">
              {{ note.symbol }}
            </span>
            
            <!-- éŸ³ç¬¦è©³ç´°æè¿° -->
            <div 
              :id="`note-${systemIndex}-${measureIndex}-${noteIndex}-desc`" 
              class="sr-only"
            >
              {{ getNoteDetailDescription(note) }}
            </div>
          </div>
        </div>
      </div>
      
      <!-- å³æ™‚ç‹€æ…‹å›é¥‹ -->
      <div 
        :id="liveRegionId"
        class="sr-only"
        role="status"
        aria-live="polite"
        aria-atomic="true"
      >
        {{ liveMessage }}
      </div>
      
      <!-- éŒ¯èª¤è¨Šæ¯ -->
      <div
        v-if="errorMessage"
        class="sr-only"
        role="alert"
        aria-live="assertive"
      >
        éŒ¯èª¤ï¼š{{ errorMessage }}
      </div>
    </main>
    
    <!-- ç‹€æ…‹æ¬„ -->
    <div 
      class="status-bar"
      role="status"
      aria-label="ç·¨è¼¯å™¨ç‹€æ…‹"
    >
      <div class="status-items">
        <div class="status-item">
          <span class="status-label">ç•¶å‰ä½ç½®ï¼š</span>
          <span class="status-value">
            ç¬¬ {{ currentMeasure }} å°ç¯€ï¼Œç¬¬ {{ currentBeat }} æ‹
          </span>
        </div>
        
        <div class="status-item">
          <span class="status-label">é¸å–é …ç›®ï¼š</span>
          <span class="status-value">
            {{ selectedCount > 0 ? `${selectedCount} å€‹éŸ³ç¬¦` : 'ç„¡' }}
          </span>
        </div>
        
        <div class="status-item">
          <span class="status-label">å·¥å…·ï¼š</span>
          <span class="status-value">{{ selectedTool?.name || 'ç„¡' }}</span>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'
import { PlayIcon, PauseIcon, StopIcon } from '@heroicons/vue/24/outline'

// å”¯ä¸€IDç”Ÿæˆ
const generateId = (prefix: string) => `${prefix}-${Math.random().toString(36).substr(2, 9)}`

const editorDescriptionId = generateId('editor-desc')
const canvasId = generateId('canvas')
const scoreDetailsId = generateId('score-details')
const liveRegionId = generateId('live-region')

// ç·¨è¼¯å™¨ç‹€æ…‹
const isPlaying = ref(false)
const selectedTool = ref(null)
const selectedNotes = ref([])
const currentMeasure = ref(1)
const currentBeat = ref(1)
const liveMessage = ref('')
const errorMessage = ref('')

// éŸ³ç¬¦å·¥å…·
const noteTools = [
  {
    id: 'whole-note',
    name: 'å…¨éŸ³ç¬¦',
    symbol: 'ğ…',
    shortcut: '1',
    ariaLabel: 'å…¨éŸ³ç¬¦å·¥å…·',
    description: 'æ’å…¥æŒçºŒå››æ‹çš„å…¨éŸ³ç¬¦'
  },
  {
    id: 'half-note', 
    name: 'äºŒåˆ†éŸ³ç¬¦',
    symbol: 'ğ…—ğ…¥',
    shortcut: '2',
    ariaLabel: 'äºŒåˆ†éŸ³ç¬¦å·¥å…·',
    description: 'æ’å…¥æŒçºŒå…©æ‹çš„äºŒåˆ†éŸ³ç¬¦'
  },
  {
    id: 'quarter-note',
    name: 'å››åˆ†éŸ³ç¬¦',
    symbol: 'â™©',
    shortcut: '4',
    ariaLabel: 'å››åˆ†éŸ³ç¬¦å·¥å…·',
    description: 'æ’å…¥æŒçºŒä¸€æ‹çš„å››åˆ†éŸ³ç¬¦'
  }
]

// è¨ˆç®—å±¬æ€§
const editorLabel = computed(() => 
  `éŸ³æ¨‚ç·¨è¼¯å™¨ - ${isPlaying.value ? 'æ’­æ”¾ä¸­' : 'å·²åœæ­¢'}`
)

const scoreDescription = computed(() => 
  `éŸ³æ¨‚æ¨‚è­œï¼ŒåŒ…å« ${staffSystems.value.length} å€‹äº”ç·šè­œç³»çµ±`
)

const scoreStructureDescription = computed(() => {
  const totalMeasures = staffSystems.value.reduce(
    (sum, system) => sum + system.measures.length, 0
  )
  return `æ¨‚è­œçµæ§‹ï¼š${staffSystems.value.length} å€‹äº”ç·šè­œç³»çµ±ï¼Œå…± ${totalMeasures} å€‹å°ç¯€`
})

const selectedCount = computed(() => selectedNotes.value.length)

const staffSystems = ref([
  {
    measures: [
      {
        notes: [
          { 
            id: 1, 
            pitch: 'C4', 
            duration: 'quarter', 
            symbol: 'â™©',
            selected: false
          }
        ]
      }
    ]
  }
])

// ç„¡éšœç¤™æ–¹æ³•
const announceCanvasFocus = () => {
  liveMessage.value = 'å·²é€²å…¥æ¨‚è­œç·¨è¼¯å€åŸŸã€‚ä½¿ç”¨æ–¹å‘éµå°èˆªï¼ŒEnter éµé¸å–éŸ³ç¬¦'
}

const announceMeasure = (systemIndex: number, measureIndex: number) => {
  liveMessage.value = `ç¬¬ ${systemIndex + 1} å€‹äº”ç·šè­œç³»çµ±ï¼Œç¬¬ ${measureIndex + 1} å°ç¯€`
}

const announceNote = (note: any) => {
  liveMessage.value = getNoteAriaLabel(note)
}

const getNoteAriaLabel = (note: any) => {
  const pitchName = getPitchName(note.pitch)
  const durationName = getDurationName(note.duration)
  return `${durationName} ${pitchName}${note.selected ? 'ï¼Œå·²é¸å–' : ''}`
}

const getNoteDetailDescription = (note: any) => {
  const pitchName = getPitchName(note.pitch)
  const durationName = getDurationName(note.duration)
  return `éŸ³ç¬¦ï¼š${pitchName}ï¼Œæ™‚å€¼ï¼š${durationName}ï¼Œä½ç½®ï¼šç¬¬ ${note.measure} å°ç¯€ç¬¬ ${note.beat} æ‹`
}

const getPitchName = (pitch: string) => {
  const pitchNames = {
    'C4': 'ä¸­å¤®C',
    'D4': 'D',
    'E4': 'E',
    'F4': 'F',
    'G4': 'G',
    'A4': 'A',
    'B4': 'B'
  }
  return pitchNames[pitch] || pitch
}

const getDurationName = (duration: string) => {
  const durationNames = {
    'whole': 'å…¨éŸ³ç¬¦',
    'half': 'äºŒåˆ†éŸ³ç¬¦',
    'quarter': 'å››åˆ†éŸ³ç¬¦',
    'eighth': 'å…«åˆ†éŸ³ç¬¦'
  }
  return durationNames[duration] || duration
}

// äº‹ä»¶è™•ç†
const selectTool = (tool: any) => {
  selectedTool.value = tool
  liveMessage.value = `å·²é¸å– ${tool.name} å·¥å…·`
}

const togglePlayback = () => {
  isPlaying.value = !isPlaying.value
  liveMessage.value = isPlaying.value ? 'é–‹å§‹æ’­æ”¾' : 'æš«åœæ’­æ”¾'
}

const stopPlayback = () => {
  isPlaying.value = false
  liveMessage.value = 'åœæ­¢æ’­æ”¾'
}

const selectNote = (note: any) => {
  note.selected = !note.selected
  if (note.selected) {
    selectedNotes.value.push(note)
    liveMessage.value = `å·²é¸å– ${getNoteAriaLabel(note)}`
  } else {
    const index = selectedNotes.value.indexOf(note)
    if (index > -1) {
      selectedNotes.value.splice(index, 1)
    }
    liveMessage.value = `å·²å–æ¶ˆé¸å– ${getNoteAriaLabel(note)}`
  }
}

const isNoteSelected = (note: any) => {
  return note.selected
}

const handleCanvasKeydown = (event: KeyboardEvent) => {
  switch (event.key) {
    case 'ArrowRight':
      event.preventDefault()
      // ç§»å‹•åˆ°ä¸‹ä¸€å€‹éŸ³ç¬¦
      liveMessage.value = 'ç§»å‹•åˆ°ä¸‹ä¸€å€‹éŸ³ç¬¦'
      break
    case 'ArrowLeft':
      event.preventDefault()
      // ç§»å‹•åˆ°ä¸Šä¸€å€‹éŸ³ç¬¦
      liveMessage.value = 'ç§»å‹•åˆ°ä¸Šä¸€å€‹éŸ³ç¬¦'
      break
    case 'Enter':
      event.preventDefault()
      // é¸å–ç•¶å‰éŸ³ç¬¦
      liveMessage.value = 'é¸å–ç•¶å‰éŸ³ç¬¦'
      break
    case 'Delete':
      event.preventDefault()
      // åˆªé™¤é¸å–çš„éŸ³ç¬¦
      liveMessage.value = 'åˆªé™¤é¸å–çš„éŸ³ç¬¦'
      break
  }
}

const handleNoteKeydown = (event: KeyboardEvent, note: any) => {
  switch (event.key) {
    case 'Enter':
    case ' ':
      event.preventDefault()
      selectNote(note)
      break
    case 'Delete':
      event.preventDefault()
      // åˆªé™¤éŸ³ç¬¦
      liveMessage.value = `åˆªé™¤ ${getNoteAriaLabel(note)}`
      break
  }
}

// éŒ¯èª¤è™•ç†
const showError = (message: string) => {
  errorMessage.value = message
  setTimeout(() => {
    errorMessage.value = ''
  }, 5000)
}

onMounted(() => {
  // åˆå§‹åŒ–ç„¡éšœç¤™è¨­å®š
  liveMessage.value = 'éŸ³æ¨‚ç·¨è¼¯å™¨å·²è¼‰å…¥'
})
</script>

<style scoped>
/* ç„¡éšœç¤™æ¨£å¼ */
.accessible-music-editor {
  @apply relative;
}

.sr-only {
  @apply absolute w-px h-px p-0 -m-px;
  @apply overflow-hidden;
  clip: rect(0, 0, 0, 0);
  @apply whitespace-nowrap;
  @apply border-0;
}

/* è·³éé€£çµæ¨£å¼ */
:global(.skip-link:focus) {
  @apply relative;
  clip: auto !important;
  @apply w-auto h-auto p-2 m-0;
  @apply overflow-visible;
  @apply whitespace-normal;
}

/* ç„¦é»æŒ‡ç¤ºå™¨ */
.tool-button:focus,
.note:focus,
.measure:focus {
  @apply outline-none;
  @apply ring-2 ring-blue-500 ring-offset-2;
  @apply ring-offset-white dark:ring-offset-gray-800;
}

/* é«˜å°æ¯”åº¦æ¨¡å¼ */
@media (prefers-contrast: high) {
  .tool-button,
  .note,
  .measure {
    @apply border-2 border-black dark:border-white;
  }
  
  .tool-button:focus,
  .note:focus,
  .measure:focus {
    @apply bg-yellow-200 dark:bg-yellow-800;
  }
}

/* æ¸›å°‘å‹•ç•«åå¥½ */
@media (prefers-reduced-motion: reduce) {
  * {
    @apply transition-none;
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    scroll-behavior: auto !important;
  }
}

/* å·¥å…·æ¬„ */
.editor-toolbar {
  @apply bg-white dark:bg-gray-800;
  @apply border-b border-gray-200 dark:border-gray-700;
  @apply p-4;
}

.tool-groups {
  @apply flex flex-wrap gap-6;
}

.tool-group {
  @apply space-y-2;
}

.tool-group-label {
  @apply text-sm font-medium;
  @apply text-gray-700 dark:text-gray-300;
}

.tool-button {
  @apply inline-flex items-center justify-center;
  @apply w-10 h-10 mr-2;
  @apply bg-gray-100 dark:bg-gray-700;
  @apply hover:bg-gray-200 dark:hover:bg-gray-600;
  @apply rounded-md;
  @apply transition-colors duration-200;
  
  &[aria-pressed="true"] {
    @apply bg-blue-100 dark:bg-blue-900;
    @apply text-blue-600 dark:text-blue-400;
  }
}

.tool-icon {
  @apply w-5 h-5;
}

/* æ¨‚è­œç•«å¸ƒ */
.score-canvas-container {
  @apply flex-1 p-4;
  @apply bg-white dark:bg-gray-900;
  @apply overflow-auto;
  @apply min-h-96;
}

.staff-system {
  @apply mb-8;
}

.measure {
  @apply inline-block mr-4 p-2;
  @apply border border-gray-200 dark:border-gray-700;
  @apply rounded;
  @apply min-w-20 min-h-16;
}

.note {
  @apply inline-block m-1 p-1;
  @apply cursor-pointer;
  @apply rounded;
  
  &[aria-selected="true"] {
    @apply bg-blue-100 dark:bg-blue-900;
    @apply text-blue-600 dark:text-blue-400;
  }
}

.note-symbol {
  @apply text-2xl;
}

/* ç‹€æ…‹æ¬„ */
.status-bar {
  @apply bg-gray-100 dark:bg-gray-800;
  @apply border-t border-gray-200 dark:border-gray-700;
  @apply p-4;
}

.status-items {
  @apply flex flex-wrap gap-6;
}

.status-item {
  @apply flex items-center space-x-2;
}

.status-label {
  @apply text-sm text-gray-600 dark:text-gray-400;
}

.status-value {
  @apply text-sm font-medium;
  @apply text-gray-900 dark:text-white;
}
</style>
```

---

## âœ… æœ¬æ–‡ä»¶åŒ…å«å…§å®¹

1. **ç„¡éšœç¤™è¨­è¨ˆæ¶æ§‹** - WCAG 2.1 AA æ¨™æº–çš„å››å±¤æ¡†æ¶
2. **éŸ³æ¨‚è»Ÿé«”å°ˆç”¨éœ€æ±‚** - è¦–è¦ºã€è½è¦ºã€æ“ä½œã€èªçŸ¥ç„¡éšœç¤™
3. **è‰²å½©èˆ‡å°æ¯”è¨­è¨ˆ** - è‰²ç›²å‹å¥½è¨­è¨ˆå’Œå°æ¯”åº¦æª¢æ¸¬
4. **éµç›¤å°èˆªç³»çµ±** - å®Œæ•´çš„éµç›¤å¿«æ·éµå’Œç„¦é»ç®¡ç†
5. **è¢å¹•é–±è®€å™¨æ”¯æ´** - ARIA æ¨™ç±¤å’Œèªæ„æ¨™è¨˜å¯¦ç¾

## ğŸ”— ç›¸é—œæ–‡ä»¶

ğŸ‘‰ **ä¸‹ä¸€æ­¥ï¼šåƒè€ƒ [10_æ€§èƒ½å„ªåŒ–è¨­è¨ˆ.md](./10_æ€§èƒ½å„ªåŒ–è¨­è¨ˆ.md) äº†è§£æ€§èƒ½å„ªåŒ–ç­–ç•¥**
